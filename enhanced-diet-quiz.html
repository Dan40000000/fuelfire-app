<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Diet Quiz - FuelFire</title>
    <link rel="stylesheet" href="styles.css">
    <script src="fuelfire-auth.js"></script>
</head>
<body>
    <div class="phone-container">
        <div class="screen">
            <div class="status-bar">
                <span id="time">9:41</span>
                <span>100%</span>
            </div>
            
            <div class="header">
                <div class="hamburger" onclick="toggleSidebar()">‚ò∞</div>
                <div class="header-title">Enhanced Diet Quiz</div>
            </div>
            
            <div class="content">
                <!-- Quick Test Button -->
                <div style="text-align: center; margin: 20px; padding: 15px; background: linear-gradient(135deg, #ff6b6b, #ee5a24); border-radius: 15px;">
                    <button onclick="quickTest()" style="background: white; color: #ee5a24; border: none; padding: 15px 30px; border-radius: 25px; font-weight: bold; font-size: 16px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                        üöÄ QUICK TEST - Skip Quiz & Generate Now!
                    </button>
                    <div style="color: white; font-size: 12px; margin-top: 8px; opacity: 0.9;">
                        Pre-fills realistic data for testing
                    </div>
                </div>
                
                <div id="quiz-content">
                    <!-- Quiz content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay for sidebar -->
    <div class="overlay" onclick="toggleSidebar()"></div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-brand">üî• FuelFire</div>
        </div>
        <div class="sidebar-menu">
            <div class="menu-item" onclick="goToPage('index.html')">üè† Home</div>
            <div class="menu-item" onclick="goToPage('create-workout.html')">üí™ Create Workout</div>
            <div class="menu-item" onclick="goToPage('saved-workouts.html')">üìö Saved Workouts</div>
            <div class="menu-item" onclick="goToPage('track-workouts.html')">üìä Track Workouts</div>
            <div class="menu-item" onclick="goToPage('calorie-tracker.html')">üî• Calorie Tracker</div>
            <div class="menu-item active" onclick="goToPage('enhanced-diet-quiz.html')">üéØ Diet Creation</div>
            <div class="menu-item" onclick="goToPage('meal-plans.html')">üçΩÔ∏è Meal Plans</div>
            <div class="menu-item" onclick="goToPage('progress.html')">üìà Progress & Analytics</div>
            <div class="menu-item">‚öôÔ∏è Settings</div>
        </div>
    </div>

    <script>
        // Enhanced Diet Quiz Variables
        let currentStep = 1;
        const totalSteps = 10;
        let quizData = {};
        let measurementSystem = 'imperial'; // 'imperial' or 'metric'

        // Helper functions for check all/none buttons
        function selectAllMeats() {
            document.querySelectorAll('.meat-check').forEach(cb => cb.checked = true);
        }

        function selectNoMeats() {
            document.querySelectorAll('.meat-check').forEach(cb => cb.checked = false);
        }

        function selectAllVeggies() {
            document.querySelectorAll('.veggie-check').forEach(cb => cb.checked = true);
        }

        function selectNoVeggies() {
            document.querySelectorAll('.veggie-check').forEach(cb => cb.checked = false);
        }

        function selectAllFruits() {
            document.querySelectorAll('.fruit-check').forEach(cb => cb.checked = true);
        }

        function selectNoFruits() {
            document.querySelectorAll('.fruit-check').forEach(cb => cb.checked = false);
        }

        function handleNoneAllergy(checkbox) {
            if (checkbox.checked) {
                document.querySelectorAll('.allergy-check').forEach(cb => {
                    if (cb !== checkbox) cb.checked = false;
                });
            }
        }

        function toggleMeasurementSystem(system) {
            measurementSystem = system;
            document.getElementById('imperial-btn').style.background = system === 'imperial' ? 'var(--primary)' : 'var(--lighter-bg)';
            document.getElementById('imperial-btn').style.color = system === 'imperial' ? 'white' : 'var(--dark)';
            document.getElementById('metric-btn').style.background = system === 'metric' ? 'var(--primary)' : 'var(--lighter-bg)';
            document.getElementById('metric-btn').style.color = system === 'metric' ? 'white' : 'var(--dark)';
            
            // Toggle height inputs
            document.getElementById('height-imperial').style.display = system === 'imperial' ? 'block' : 'none';
            document.getElementById('height-metric').style.display = system === 'metric' ? 'block' : 'none';
            
            // Update weight label
            document.getElementById('weight-label').innerHTML = `Weight (${system === 'imperial' ? 'lbs' : 'kg'}) <span style="color: #e74c3c;">*</span>`;
            document.getElementById('quiz-weight').placeholder = system === 'imperial' ? '150' : '68';
        }

        function goBack() {
            window.location.href = 'index.html';
        }
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.overlay');
            sidebar.classList.toggle('open');
            overlay.classList.toggle('show');
        }
        
        function goToPage(page) {
            window.location.href = page;
        }

        // Quick Test Function - Pre-fills realistic data and generates immediately
        async function quickTest() {
            // Pre-fill with realistic test data
            quizData = {
                goal: 'weight-loss',
                calories: 'auto-calculate',
                age: '30',
                gender: 'male',
                weight: '180',
                activity: 'moderate',
                bodytype: 'mesomorph',
                measurementSystem: 'imperial',
                feet: '6',
                inches: '0',
                allergies: ['None'],
                otherAllergies: 'N/A',
                dietaryLifestyle: 'no-restrictions',
                meats: ['üêî Chicken Breast', 'üêü Salmon', 'ü•ö Eggs', 'üêÑ Ground Beef (93/7)', 'ü¶É Turkey'],
                meatFrequency: 'twice-daily',
                vegetables: ['ü•¨ Spinach', 'ü•¶ Broccoli', 'ü•ï Carrots', 'üçÖ Tomatoes', 'ü•í Cucumber'],
                fruits: ['üçé Apples', 'üçå Bananas', 'ü´ê Blueberries', 'üçì Strawberries'],
                exerciseType: 'weight-training',
                exerciseFrequency: '4-5-days',
                workoutDuration: '45-60-min',
                fitnessGoal: 'build-muscle-lose-fat',
                mealsPerDay: '3',
                largestMeal: 'dinner',
                mealPrepTime: 'moderate',
                mealVariety: 'weekday-same',
                mealStyle: 'international-adventure',
                cookingSkill: 'intermediate',
                kitchenEquipment: ['Oven', 'Stovetop', 'Air Fryer'],
                budgetRange: 'moderate',
                preferredStores: ['Any Store'],
                planDuration: '2-week',
                specialRequests: 'I love spicy food and want exciting flavors!'
            };

            console.log('üöÄ Quick Test activated with data:', quizData);

            // Show loading state
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = 'ü§ñ Quick generating...';
            button.disabled = true;

            try {
                // Generate meal plan immediately
                const result = await window.fuelFireAuth.generateMealPlan(quizData);
                
                if (result.success) {
                    // Save meal plan to localStorage
                    const savedPlanId = saveMealPlanToStorage(result.mealPlan, result.metadata);
                    
                    // Update button to show success
                    button.innerHTML = '‚úÖ Generated! Redirecting...';
                    
                    // Redirect to meal plan
                    setTimeout(() => {
                        window.location.href = `meal-plan-simple.html?planId=${savedPlanId}`;
                    }, 1000);
                    
                } else {
                    throw new Error(result.message || 'Failed to generate meal plan');
                }
                
            } catch (error) {
                console.error('‚ùå Quick test error:', error);
                alert(`‚ùå Quick test failed: ${error.message}`);
                
                // Reset button
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        function updateTime() {
            const now = new Date();
            const time = now.toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            });
            document.getElementById('time').textContent = time;
        }

        function showStep(step) {
            const content = document.getElementById('quiz-content');
            let html = '';

            if (step === 1) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">üéØ Your Goals</h2>
                        <p style="opacity: 0.9;">Step 1 of 10 - Let's start with your objectives</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">What's your primary goal? <span style="color: #e74c3c;">*</span></label>
                            <select id="diet-goal" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select your goal...</option>
                                <option value="weight-loss">üî• Weight Loss</option>
                                <option value="muscle-gain">üí™ Muscle Gain</option>
                                <option value="maintenance">‚öñÔ∏è Maintenance</option>
                                <option value="recomp">üîÑ Body Recomposition</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Daily calorie target (optional)</label>
                            <input type="number" id="calorie-target" placeholder="Leave blank for automatic calculation" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px;">
                        </div>
                        
                        <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; width: 100%; font-weight: bold; cursor: pointer; font-size: 18px;">
                            Continue ‚Üí
                        </button>
                    </div>
                `;
            } else if (step === 2) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">üë§ Personal Information</h2>
                        <p style="opacity: 0.9;">Step 2 of 10 - Help us understand your needs</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                            <div>
                                <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Age <span style="color: #e74c3c;">*</span></label>
                                <input type="number" id="quiz-age" placeholder="25" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px;">
                            </div>
                            <div>
                                <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Gender <span style="color: #e74c3c;">*</span></label>
                                <select id="quiz-gender" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px;">
                                    <option value="">Select...</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Measurement System</label>
                            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                                <button type="button" id="imperial-btn" onclick="toggleMeasurementSystem('imperial')" style="background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; flex: 1; font-weight: bold;">
                                    üá∫üá∏ Imperial (lb/ft)
                                </button>
                                <button type="button" id="metric-btn" onclick="toggleMeasurementSystem('metric')" style="background: var(--lighter-bg); color: var(--dark); border: 1px solid #ddd; padding: 10px 20px; border-radius: 10px; cursor: pointer; flex: 1; font-weight: bold;">
                                    üåç Metric (kg/cm)
                                </button>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label id="weight-label" style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Weight (lbs) <span style="color: #e74c3c;">*</span></label>
                            <input type="number" id="quiz-weight" placeholder="150" style="width: 100%; padding: 18px; border: 2px solid #ddd; border-radius: 12px; font-size: 18px; font-weight: bold; text-align: center; box-sizing: border-box;">
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Height</label>
                            <div id="height-imperial" style="display: block;">
                                <div style="display: flex; gap: 12px; align-items: center;">
                                    <div style="flex: 1;">
                                        <input type="number" id="quiz-feet" placeholder="5" min="3" max="8" style="width: 100%; padding: 18px; border: 2px solid #ddd; border-radius: 12px; font-size: 18px; font-weight: bold; text-align: center; box-sizing: border-box;">
                                        <label style="font-size: 14px; color: #666; margin-top: 4px; display: block; text-align: center; font-weight: bold;">feet</label>
                                    </div>
                                    <div style="flex: 1;">
                                        <input type="number" id="quiz-inches" placeholder="8" min="0" max="11" style="width: 100%; padding: 18px; border: 2px solid #ddd; border-radius: 12px; font-size: 18px; font-weight: bold; text-align: center; box-sizing: border-box;">
                                        <label style="font-size: 14px; color: #666; margin-top: 4px; display: block; text-align: center; font-weight: bold;">inches</label>
                                    </div>
                                </div>
                            </div>
                            <div id="height-metric" style="display: none;">
                                <input type="number" id="quiz-height-cm" placeholder="173" style="width: 100%; padding: 18px; border: 2px solid #ddd; border-radius: 12px; font-size: 18px; font-weight: bold; text-align: center; box-sizing: border-box;">
                                <label style="font-size: 14px; color: #666; margin-top: 4px; display: block; text-align: center; font-weight: bold;">centimeters</label>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Activity Level</label>
                            <select id="quiz-activity" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px;">
                                <option value="">Select your activity level...</option>
                                <option value="sedentary">Sedentary (little/no exercise)</option>
                                <option value="light">Light (exercise 1-3 days/week)</option>
                                <option value="moderate">Moderate (exercise 3-5 days/week)</option>
                                <option value="very-active">Very Active (exercise 6-7 days/week)</option>
                                <option value="extra-active">Extra Active (physical job + exercise)</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Body Type</label>
                            <select id="quiz-bodytype" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px;">
                                <option value="">Select your body type...</option>
                                <option value="ectomorph">Ectomorph (Naturally thin, fast metabolism)</option>
                                <option value="mesomorph">Mesomorph (Athletic build, gains muscle easily)</option>
                                <option value="endomorph">Endomorph (Stocky build, slower metabolism)</option>
                                <option value="unknown">I DON'T KNOW</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Continue ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (step === 3) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">ü•ó Dietary Restrictions</h2>
                        <p style="opacity: 0.9;">Step 3 of 10 - What should we avoid?</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 12px; font-weight: bold;">Food Allergies (check all that apply)</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; max-height: 280px; overflow-y: auto; border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="None" style="margin-right: 8px;" onchange="handleNoneAllergy(this)">
                                    <span>None</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Gluten" style="margin-right: 8px;">
                                    <span>Gluten</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Dairy/Lactose" style="margin-right: 8px;">
                                    <span>Dairy/Lactose</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Eggs" style="margin-right: 8px;">
                                    <span>Eggs</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Peanuts" style="margin-right: 8px;">
                                    <span>Peanuts</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Tree Nuts" style="margin-right: 8px;">
                                    <span>Tree Nuts</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Shellfish" style="margin-right: 8px;">
                                    <span>Shellfish</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Fish" style="margin-right: 8px;">
                                    <span>Fish</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Soy" style="margin-right: 8px;">
                                    <span>Soy</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Sesame" style="margin-right: 8px;">
                                    <span>Sesame</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Wheat" style="margin-right: 8px;">
                                    <span>Wheat</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Corn" style="margin-right: 8px;">
                                    <span>Corn</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Sulfites" style="margin-right: 8px;">
                                    <span>Sulfites</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Nightshades" style="margin-right: 8px;">
                                    <span>Nightshades</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="MSG" style="margin-right: 8px;">
                                    <span>MSG</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 10px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="allergy-check" value="Artificial Colors" style="margin-right: 8px;">
                                    <span>Artificial Colors</span>
                                </label>
                            </div>
                            
                            <div style="margin-top: 15px;">
                                <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Other Allergies (please specify)</label>
                                <input type="text" id="other-allergies" placeholder="Type any other allergies or food intolerances..." style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px;">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 12px; font-weight: bold;">Dietary Lifestyle</label>
                            <select id="quiz-dietary-lifestyle" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px;">
                                <option value="omnivore">Omnivore (eat everything)</option>
                                <option value="vegetarian">Vegetarian (no meat)</option>
                                <option value="vegan">Vegan (no animal products)</option>
                                <option value="pescatarian">Pescatarian (fish only)</option>
                                <option value="keto">Keto (very low carb)</option>
                                <option value="paleo">Paleo (whole foods only)</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Continue ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (step === 4) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">ü•© Meat Preferences</h2>
                        <p style="opacity: 0.9;">Step 4 of 10 - What meats do you enjoy?</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <label style="color: var(--dark); font-weight: bold;">Select all meats you enjoy eating</label>
                                <div style="display: flex; gap: 8px;">
                                    <button type="button" onclick="selectAllMeats()" style="background: #28a745; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                        Check All
                                    </button>
                                    <button type="button" onclick="selectNoMeats()" style="background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                        Check None
                                    </button>
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; max-height: 320px; overflow-y: auto; border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêì Chicken Breast" style="margin-right: 8px;">
                                    <span>üêì Chicken Breast</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêì Chicken Thighs" style="margin-right: 8px;">
                                    <span>üêì Chicken Thighs</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêì Chicken Wings" style="margin-right: 8px;">
                                    <span>üêì Chicken Wings</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü¶É Turkey Breast" style="margin-right: 8px;">
                                    <span>ü¶É Turkey Breast</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü¶É Ground Turkey" style="margin-right: 8px;">
                                    <span>ü¶É Ground Turkey</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü•© Lean Ground Beef" style="margin-right: 8px;">
                                    <span>ü•© Lean Ground Beef</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü•© Sirloin Steak" style="margin-right: 8px;">
                                    <span>ü•© Sirloin Steak</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü•© Filet Mignon" style="margin-right: 8px;">
                                    <span>ü•© Filet Mignon</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêñ Pork Tenderloin" style="margin-right: 8px;">
                                    <span>üêñ Pork Tenderloin</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêñ Pork Chops" style="margin-right: 8px;">
                                    <span>üêñ Pork Chops</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêë Lamb Chops" style="margin-right: 8px;">
                                    <span>üêë Lamb Chops</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêë Ground Lamb" style="margin-right: 8px;">
                                    <span>üêë Ground Lamb</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü•ö Eggs" style="margin-right: 8px;">
                                    <span>ü•ö Eggs</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêü Salmon" style="margin-right: 8px;">
                                    <span>üêü Salmon</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêü Tuna" style="margin-right: 8px;">
                                    <span>üêü Tuna</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêü Cod" style="margin-right: 8px;">
                                    <span>üêü Cod</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêü Tilapia" style="margin-right: 8px;">
                                    <span>üêü Tilapia</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üêü Mahi Mahi" style="margin-right: 8px;">
                                    <span>üêü Mahi Mahi</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü¶ê Shrimp" style="margin-right: 8px;">
                                    <span>ü¶ê Shrimp</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü¶Ä Crab" style="margin-right: 8px;">
                                    <span>ü¶Ä Crab</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü¶û Lobster" style="margin-right: 8px;">
                                    <span>ü¶û Lobster</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü¶Ü Duck" style="margin-right: 8px;">
                                    <span>ü¶Ü Duck</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü¶å Venison" style="margin-right: 8px;">
                                    <span>ü¶å Venison</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="ü•ì Bacon" style="margin-right: 8px;">
                                    <span>ü•ì Bacon</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="meat-check" value="üå≠ Sausages" style="margin-right: 8px;">
                                    <span>üå≠ Sausages</span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">How often do you want to eat meat?</label>
                            <select id="quiz-meat-frequency" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px;">
                                <option value="every-meal">Every meal</option>
                                <option value="twice-daily">Twice per day</option>
                                <option value="once-daily">Once per day</option>
                                <option value="few-times-week">Few times per week</option>
                                <option value="rarely">Rarely</option>
                                <option value="never">Never (plant-based only)</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Continue ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (step === 5) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">ü•¨ Vegetable Preferences</h2>
                        <p style="opacity: 0.9;">Step 5 of 10 - Choose your vegetables</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <label style="color: var(--dark); font-weight: bold;">Select vegetables you enjoy</label>
                                <div style="display: flex; gap: 8px;">
                                    <button type="button" onclick="selectAllVeggies()" style="background: #28a745; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                        Check All
                                    </button>
                                    <button type="button" onclick="selectNoVeggies()" style="background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                        Check None
                                    </button>
                                </div>
                            </div>
                            <p style="font-style: italic; color: #666; margin-bottom: 12px; font-size: 14px;">
                                <em>Recommended: Choose at least 5-8 vegetables for variety</em>
                            </p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; max-height: 320px; overflow-y: auto; border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•¨ Spinach" style="margin-right: 8px;" checked>
                                    <span>ü•¨ Spinach</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•¶ Broccoli" style="margin-right: 8px;" checked>
                                    <span>ü•¶ Broccoli</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•ï Carrots" style="margin-right: 8px;" checked>
                                    <span>ü•ï Carrots</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üçÖ Tomatoes" style="margin-right: 8px;" checked>
                                    <span>üçÖ Tomatoes</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üå∂Ô∏è Bell Peppers" style="margin-right: 8px;" checked>
                                    <span>üå∂Ô∏è Bell Peppers</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•í Cucumbers" style="margin-right: 8px;" checked>
                                    <span>ü•í Cucumbers</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üßÖ Onions" style="margin-right: 8px;" checked>
                                    <span>üßÖ Onions</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•ë Avocados" style="margin-right: 8px;" checked>
                                    <span>ü•ë Avocados</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•¨ Kale" style="margin-right: 8px;" checked>
                                    <span>ü•¨ Kale</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üçÑ Mushrooms" style="margin-right: 8px;" checked>
                                    <span>üçÑ Mushrooms</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üåΩ Corn" style="margin-right: 8px;" checked>
                                    <span>üåΩ Corn</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•î Potatoes" style="margin-right: 8px;" checked>
                                    <span>ü•î Potatoes</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üç† Sweet Potatoes" style="margin-right: 8px;" checked>
                                    <span>üç† Sweet Potatoes</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üßÑ Garlic" style="margin-right: 8px;" checked>
                                    <span>üßÑ Garlic</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•¨ Lettuce" style="margin-right: 8px;" checked>
                                    <span>ü•¨ Lettuce</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üå∂Ô∏è Jalape√±os" style="margin-right: 8px;" checked>
                                    <span>üå∂Ô∏è Jalape√±os</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•í Zucchini" style="margin-right: 8px;" checked>
                                    <span>ü•í Zucchini</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üçÜ Eggplant" style="margin-right: 8px;" checked>
                                    <span>üçÜ Eggplant</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•ï Baby Carrots" style="margin-right: 8px;" checked>
                                    <span>ü•ï Baby Carrots</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•ú Green Beans" style="margin-right: 8px;" checked>
                                    <span>ü•ú Green Beans</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•¨ Arugula" style="margin-right: 8px;" checked>
                                    <span>ü•¨ Arugula</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•í Celery" style="margin-right: 8px;" checked>
                                    <span>ü•í Celery</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•¨ Cabbage" style="margin-right: 8px;" checked>
                                    <span>ü•¨ Cabbage</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="ü•ï Beets" style="margin-right: 8px;" checked>
                                    <span>ü•ï Beets</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="veggie-check" value="üåø Herbs (Basil, Cilantro)" style="margin-right: 8px;" checked>
                                    <span>üåø Herbs (Basil, Cilantro)</span>
                                </label>
                            </div>
                            <p style="font-style: italic; color: #888; margin-top: 8px; font-size: 12px;">
                                <em>All vegetables are pre-selected. Uncheck any you don't want in your meal plans.</em>
                            </p>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Continue ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (step === 6) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">üçé Fruit Preferences</h2>
                        <p style="opacity: 0.9;">Step 6 of 10 - Choose your favorite fruits</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <label style="color: var(--dark); font-weight: bold;">Select fruits you enjoy eating</label>
                                <div style="display: flex; gap: 8px;">
                                    <button type="button" onclick="selectAllFruits()" style="background: #28a745; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                        Check All
                                    </button>
                                    <button type="button" onclick="selectNoFruits()" style="background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                        Check None
                                    </button>
                                </div>
                            </div>
                            <p style="font-style: italic; color: #666; margin-bottom: 12px; font-size: 14px;">
                                <em>Critical for clean eating - fruits provide natural sugars, vitamins, and fiber</em>
                            </p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; max-height: 320px; overflow-y: auto; border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçé Apples" style="margin-right: 8px;" checked>
                                    <span>üçé Apples</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçå Bananas" style="margin-right: 8px;" checked>
                                    <span>üçå Bananas</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="ü´ê Blueberries" style="margin-right: 8px;" checked>
                                    <span>ü´ê Blueberries</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçì Strawberries" style="margin-right: 8px;" checked>
                                    <span>üçì Strawberries</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçá Grapes" style="margin-right: 8px;" checked>
                                    <span>üçá Grapes</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçä Oranges" style="margin-right: 8px;" checked>
                                    <span>üçä Oranges</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="ü•≠ Mango" style="margin-right: 8px;" checked>
                                    <span>ü•≠ Mango</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçç Pineapple" style="margin-right: 8px;" checked>
                                    <span>üçç Pineapple</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="ü•ù Kiwi" style="margin-right: 8px;" checked>
                                    <span>ü•ù Kiwi</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçë Cherries" style="margin-right: 8px;" checked>
                                    <span>üçë Cherries</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçí Dark Cherries" style="margin-right: 8px;" checked>
                                    <span>üçí Dark Cherries</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçë Peaches" style="margin-right: 8px;" checked>
                                    <span>üçë Peaches</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçê Pears" style="margin-right: 8px;" checked>
                                    <span>üçê Pears</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="ü•• Coconut" style="margin-right: 8px;" checked>
                                    <span>ü•• Coconut</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçà Cantaloupe" style="margin-right: 8px;" checked>
                                    <span>üçà Cantaloupe</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçâ Watermelon" style="margin-right: 8px;" checked>
                                    <span>üçâ Watermelon</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="üçã Lemons" style="margin-right: 8px;" checked>
                                    <span>üçã Lemons</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="ü•≠ Papaya" style="margin-right: 8px;" checked>
                                    <span>ü•≠ Papaya</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="ü´ê Blackberries" style="margin-right: 8px;" checked>
                                    <span>ü´ê Blackberries</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="fruit-check" value="ü´ê Raspberries" style="margin-right: 8px;" checked>
                                    <span>ü´ê Raspberries</span>
                                </label>
                            </div>
                            <p style="font-style: italic; color: #888; margin-top: 8px; font-size: 12px;">
                                <em>All fruits are pre-selected. Uncheck any you don't want in your meal plans.</em>
                            </p>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Continue ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (step === 7) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">üí™ Exercise & Activity</h2>
                        <p style="opacity: 0.9;">Step 7 of 10 - Your fitness routine</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">What type of exercise do you prefer?</label>
                            <select id="quiz-exercise-type" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select exercise type...</option>
                                <option value="strength-training">üí™ Strength Training</option>
                                <option value="cardio">üèÉ Cardio (Running, Cycling)</option>
                                <option value="hiit">üî• HIIT (High Intensity)</option>
                                <option value="yoga-pilates">üßò Yoga/Pilates</option>
                                <option value="sports">‚öΩ Sports (Team/Individual)</option>
                                <option value="mixed">üéØ Mixed (Variety)</option>
                                <option value="minimal">üö∂ Light Activity Only</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">How many days per week do you exercise?</label>
                            <select id="quiz-exercise-frequency" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select frequency...</option>
                                <option value="0-1">0-1 days (Sedentary)</option>
                                <option value="2-3">2-3 days (Light)</option>
                                <option value="4-5">4-5 days (Moderate)</option>
                                <option value="6-7">6-7 days (Very Active)</option>
                                <option value="multiple-daily">Multiple sessions daily</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Average workout duration</label>
                            <select id="quiz-workout-duration" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select duration...</option>
                                <option value="15-30">15-30 minutes</option>
                                <option value="30-45">30-45 minutes</option>
                                <option value="45-60">45-60 minutes</option>
                                <option value="60-90">60-90 minutes</option>
                                <option value="90+">90+ minutes</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Current fitness goal</label>
                            <select id="quiz-fitness-goal" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select fitness goal...</option>
                                <option value="lose-fat">üî• Lose Body Fat</option>
                                <option value="build-muscle">üí™ Build Muscle Mass</option>
                                <option value="improve-endurance">üèÉ Improve Endurance</option>
                                <option value="increase-strength">üèãÔ∏è Increase Strength</option>
                                <option value="general-health">‚ù§Ô∏è General Health & Wellness</option>
                                <option value="athletic-performance">üèÜ Athletic Performance</option>
                                <option value="maintain">‚öñÔ∏è Maintain Current Fitness</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Continue ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (step === 8) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">üçΩÔ∏è Meal Timing & Prep</h2>
                        <p style="opacity: 0.9;">Step 8 of 10 - Your eating preferences</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">How many meals do you prefer per day?</label>
                            <select id="quiz-meals-per-day" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select meal frequency...</option>
                                <option value="2">2 meals (Intermittent Fasting)</option>
                                <option value="3">3 meals (Traditional)</option>
                                <option value="4">4 meals (3 + 1 snack)</option>
                                <option value="5">5 meals (3 + 2 snacks)</option>
                                <option value="6">6 meals (Small, frequent)</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">When do you prefer your largest meal?</label>
                            <select id="quiz-largest-meal" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select timing...</option>
                                <option value="breakfast">üåÖ Breakfast (Front-load calories)</option>
                                <option value="lunch">‚òÄÔ∏è Lunch (Midday fuel)</option>
                                <option value="dinner">üåô Dinner (Evening meal)</option>
                                <option value="post-workout">üí™ Post-Workout (Whenever I train)</option>
                                <option value="equal">‚öñÔ∏è All meals equal size</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">How much time can you dedicate to meal prep?</label>
                            <select id="quiz-meal-prep-time" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select prep time...</option>
                                <option value="minimal">‚ö° Minimal (5-15 min/day)</option>
                                <option value="moderate">üç≥ Moderate (30-60 min/day)</option>
                                <option value="extensive">üë®‚Äçüç≥ Extensive (1-2 hours on weekends)</option>
                                <option value="batch">üì¶ Batch Prep (Sunday meal prep)</option>
                                <option value="no-prep">ü•° No Prep (Ready-made meals)</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Meal variety preference</label>
                            <select id="quiz-meal-variety" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select your preference...</option>
                                <option value="same-daily">üîÑ Same meals every day (easier meal prep)</option>
                                <option value="weekday-same">üíº Same meals Mon-Fri, different weekends</option>
                                <option value="some-variety">üé≤ Some variety (2-3 breakfast/lunch options)</option>
                                <option value="full-variety">üåà Different meals every day</option>
                                <option value="office-prep">üè¢ Office days same, WFH days different</option>
                            </select>
                            <p style="font-size: 12px; color: #666; margin-top: 5px; font-style: italic;">
                                üí° Tip: Repeating meals makes shopping & prep easier!
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Meal style preference</label>
                            <select id="quiz-meal-style" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select your style...</option>
                                <option value="simple-clean">ü•ó Keep it Simple & Clean (basic healthy meals)</option>
                                <option value="balanced-creative">üé® Balanced & Creative (some flavor variety)</option>
                                <option value="international-adventure">üåé International Adventure (diverse cuisines & spices)</option>
                                <option value="comfort-healthy">üç≤ Healthy Comfort Food (familiar favorites made healthier)</option>
                                <option value="gourmet-exciting">‚≠ê Gourmet & Exciting (complex flavors & techniques)</option>
                            </select>
                            <p style="font-size: 12px; color: #666; margin-top: 5px; font-style: italic;">
                                üçΩÔ∏è This determines how creative and adventurous your meals will be!
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Cooking skill level</label>
                            <select id="quiz-cooking-skill" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select skill level...</option>
                                <option value="beginner">ü•Ñ Beginner (Basic recipes only)</option>
                                <option value="intermediate">üç≥ Intermediate (Can follow most recipes)</option>
                                <option value="advanced">üë®‚Äçüç≥ Advanced (Comfortable with complex recipes)</option>
                                <option value="expert">‚≠ê Expert (Can adapt and create recipes)</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Kitchen equipment available (check all that apply)</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; max-height: 200px; overflow-y: auto; border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="equipment-check" value="Oven" style="margin-right: 8px;" checked>
                                    <span>üî• Oven</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="equipment-check" value="Stovetop" style="margin-right: 8px;" checked>
                                    <span>üç≥ Stovetop</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="equipment-check" value="Microwave" style="margin-right: 8px;" checked>
                                    <span>üìª Microwave</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="equipment-check" value="Air Fryer" style="margin-right: 8px;">
                                    <span>üí® Air Fryer</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="equipment-check" value="Slow Cooker" style="margin-right: 8px;">
                                    <span>üç≤ Slow Cooker</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="equipment-check" value="Instant Pot" style="margin-right: 8px;">
                                    <span>‚ö° Instant Pot</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="equipment-check" value="Grill" style="margin-right: 8px;">
                                    <span>üî• Grill</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="equipment-check" value="Blender" style="margin-right: 8px;">
                                    <span>üå™Ô∏è Blender</span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Continue ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (step === 9) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">üí∞ Budget & Final Preferences</h2>
                        <p style="opacity: 0.9;">Step 9 of 10 - Almost finished!</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px;">
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Weekly grocery budget (optional)</label>
                            <select id="quiz-budget-range" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select budget range...</option>
                                <option value="budget">üíµ Budget-friendly ($30-50/week)</option>
                                <option value="moderate">üí∞ Moderate ($50-100/week)</option>
                                <option value="premium">üíé Premium ($100-150/week)</option>
                                <option value="unlimited">üéØ Cost is not a concern</option>
                                <option value="prefer-not-to-say">ü§ê Prefer not to say</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Do you shop at specific stores?</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; max-height: 150px; overflow-y: auto; border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="store-check" value="Any Store" style="margin-right: 8px;" checked>
                                    <span>Any Store</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="store-check" value="Walmart" style="margin-right: 8px;">
                                    <span>üõí Walmart</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="store-check" value="Target" style="margin-right: 8px;">
                                    <span>üéØ Target</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="store-check" value="Whole Foods" style="margin-right: 8px;">
                                    <span>ü•ó Whole Foods</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="store-check" value="Kroger" style="margin-right: 8px;">
                                    <span>üè™ Kroger</span>
                                </label>
                                <label style="background: var(--lighter-bg); padding: 8px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 13px;">
                                    <input type="checkbox" class="store-check" value="Costco/BJs" style="margin-right: 8px;">
                                    <span>üì¶ Costco/BJs</span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Preferred meal plan duration</label>
                            <select id="quiz-plan-duration" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Select duration...</option>
                                <option value="1-week">üìÖ 1 Week Plan</option>
                                <option value="2-week">üìÖ 2 Week Plan (Recommended)</option>
                                <option value="4-week">üìÖ 4 Week Plan</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: var(--dark); margin-bottom: 8px; font-weight: bold;">Any special requests or notes?</label>
                            <textarea id="quiz-special-requests" placeholder="Any specific foods you love/hate, medical conditions, or special preferences... (Type 'N/A' if nothing applies)" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 14px; min-height: 80px; resize: vertical; box-sizing: border-box;"></textarea>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 15px; margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 5px;">üéØ Ready for Your Personalized Plan?</div>
                            <div style="font-size: 14px; opacity: 0.9;">Your AI-generated meal plan will include exact measurements, cooking instructions, and organized shopping lists!</div>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Finish Quiz ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (step === 10) {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">üéØ Quiz Complete!</h2>
                        <p style="opacity: 0.9;">Step 10 of 10 - Ready to generate your plan</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px; text-align: center;">
                        <h3 style="color: var(--dark); margin-bottom: 20px;">üéâ Your Enhanced Diet Quiz is Complete!</h3>
                        <p style="color: #666; margin-bottom: 25px;">We've collected all your preferences and will generate a personalized 2-week meal plan with shopping lists.</p>
                        
                        <button onclick="generatePlan()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 20px 40px; border-radius: 25px; font-weight: bold; cursor: pointer; font-size: 18px; margin-bottom: 15px;">
                            üöÄ Generate My AI Meal Plan
                        </button>
                        
                        <div style="margin-top: 20px;">
                            <button onclick="goBack()" style="background: #6c757d; color: white; border: none; padding: 12px 25px; border-radius: 20px; cursor: pointer;">
                                ‚Üê Back to Main App
                            </button>
                        </div>
                    </div>
                `;
            } else {
                html = `
                    <div style="background: var(--gradient-1); color: white; padding: 30px; border-radius: 25px; margin-bottom: 25px; text-align: center;">
                        <h2 style="font-size: 28px; margin-bottom: 10px;">üöß Step ${step}</h2>
                        <p style="opacity: 0.9;">Step ${step} of 10 - Coming soon!</p>
                    </div>
                    
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 20px; text-align: center;">
                        <p style="color: #666; margin-bottom: 25px;">This step is still being built. You can see steps 1-5 and 9 are working!</p>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="prevStep()" style="background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 1; font-weight: bold; cursor: pointer;">
                                ‚Üê Back
                            </button>
                            <button onclick="nextStep()" style="background: var(--gradient-1); color: white; border: none; padding: 15px 30px; border-radius: 25px; flex: 2; font-weight: bold; cursor: pointer;">
                                Skip ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            }

            content.innerHTML = html;
        }

        function nextStep() {
            // Save current step data
            if (currentStep === 1) {
                quizData.goal = document.getElementById('diet-goal').value;
                quizData.calories = document.getElementById('calorie-target').value;
                
                if (!quizData.goal) {
                    alert('Please select your goal');
                    return;
                }
            } else if (currentStep === 2) {
                quizData.age = document.getElementById('quiz-age').value;
                quizData.gender = document.getElementById('quiz-gender').value;
                quizData.weight = document.getElementById('quiz-weight').value;
                quizData.activity = document.getElementById('quiz-activity').value;
                quizData.bodytype = document.getElementById('quiz-bodytype').value;
                
                // Store height based on measurement system
                if (measurementSystem === 'imperial') {
                    quizData.feet = document.getElementById('quiz-feet').value;
                    quizData.inches = document.getElementById('quiz-inches').value;
                } else {
                    quizData.heightCm = document.getElementById('quiz-height-cm').value;
                }
                quizData.measurementSystem = measurementSystem;
                
                // Validate required fields
                if (!quizData.age) {
                    alert('‚ùó Please enter your age');
                    return;
                }
                if (!quizData.weight) {
                    alert('‚ùó Please enter your weight');
                    return;
                }
                if (!quizData.gender) {
                    alert('‚ùó Please select your gender');
                    return;
                }
            } else if (currentStep === 3) {
                quizData.allergies = Array.from(document.querySelectorAll('.allergy-check:checked')).map(cb => cb.value);
                quizData.otherAllergies = document.getElementById('other-allergies').value || 'N/A';
                quizData.dietaryLifestyle = document.getElementById('quiz-dietary-lifestyle').value;
            } else if (currentStep === 4) {
                quizData.meats = Array.from(document.querySelectorAll('.meat-check:checked')).map(cb => cb.value);
                quizData.meatFrequency = document.getElementById('quiz-meat-frequency').value;
            } else if (currentStep === 5) {
                quizData.vegetables = Array.from(document.querySelectorAll('.veggie-check:checked')).map(cb => cb.value);
            } else if (currentStep === 6) {
                quizData.fruits = Array.from(document.querySelectorAll('.fruit-check:checked')).map(cb => cb.value);
            } else if (currentStep === 7) {
                quizData.exerciseType = document.getElementById('quiz-exercise-type').value;
                quizData.exerciseFrequency = document.getElementById('quiz-exercise-frequency').value;
                quizData.workoutDuration = document.getElementById('quiz-workout-duration').value;
                quizData.fitnessGoal = document.getElementById('quiz-fitness-goal').value;
            } else if (currentStep === 8) {
                quizData.mealsPerDay = document.getElementById('quiz-meals-per-day').value;
                quizData.largestMeal = document.getElementById('quiz-largest-meal').value;
                quizData.mealPrepTime = document.getElementById('quiz-meal-prep-time').value;
                quizData.mealVariety = document.getElementById('quiz-meal-variety').value;
                quizData.mealStyle = document.getElementById('quiz-meal-style').value || 'balanced-creative';
                quizData.cookingSkill = document.getElementById('quiz-cooking-skill').value;
                quizData.kitchenEquipment = Array.from(document.querySelectorAll('.equipment-check:checked')).map(cb => cb.value);
            } else if (currentStep === 9) {
                quizData.budgetRange = document.getElementById('quiz-budget-range').value;
                quizData.preferredStores = Array.from(document.querySelectorAll('.store-check:checked')).map(cb => cb.value);
                quizData.planDuration = document.getElementById('quiz-plan-duration').value;
                quizData.specialRequests = document.getElementById('quiz-special-requests').value || 'N/A';
            }
            
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        async function generatePlan() {
            const goal = quizData.goal || 'maintenance';
            
            // Validate we have enough data
            if (!quizData.goal || !quizData.age || !quizData.weight) {
                alert('‚ö†Ô∏è Please complete all required fields in the quiz first!');
                return;
            }
            
            // Show confirmation with collected data summary
            const dataCount = `${quizData.meats?.length || 0} meats, ${quizData.vegetables?.length || 0} vegetables, ${quizData.fruits?.length || 0} fruits`;
            if (!confirm(`üéØ Generate AI meal plan for ${goal.replace('-', ' ')} goal?\n\nüìä Your preferences: ${dataCount}\nü§ñ This will use Claude AI to create your personalized 2-week plan!`)) {
                return;
            }
            
            // Show loading state
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = 'ü§ñ Claude AI is creating your plan...';
            button.disabled = true;
            
            try {
                console.log('üî• Starting meal plan generation with quiz data:', Object.keys(quizData));
                console.log('üîç Full quiz data:', quizData);
                
                // Generate meal plan using Claude AI through your account
                const result = await window.fuelFireAuth.generateMealPlan(quizData);
                
                if (result.success) {
                    // Save meal plan to localStorage for the meal-plans.html page
                    const savedPlanId = saveMealPlanToStorage(result.mealPlan, result.metadata);
                    
                    // Update button to show success
                    button.innerHTML = '‚úÖ Plan Generated! Redirecting...';
                    
                    // Redirect after short delay - using plan ID instead of data in URL
                    setTimeout(() => {
                        window.location.href = `meal-plan-simple.html?planId=${savedPlanId}`;
                    }, 1000);
                    
                } else {
                    throw new Error(result.message || 'Failed to generate meal plan');
                }
                
            } catch (error) {
                console.error('‚ùå Error generating meal plan:', error);
                
                // Show user-friendly error
                alert(`‚ùå Oops! Something went wrong:\n\n${error.message}\n\nPlease try again in a moment. If the problem persists, check your internet connection.`);
                
                // Reset button
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        function saveMealPlanToStorage(mealPlan, metadata) {
            try {
                // Get existing meal plans from localStorage
                const existingPlans = localStorage.getItem('fuelfire_meal_plans');
                const mealPlans = existingPlans ? JSON.parse(existingPlans) : [];
                
                // Create new meal plan object
                const newPlan = {
                    mealPlan: mealPlan,
                    metadata: {
                        ...metadata,
                        createdAt: new Date().toISOString()
                    },
                    id: Date.now().toString() // Simple unique ID
                };
                
                // Add to beginning of array (newest first)
                mealPlans.unshift(newPlan);
                
                // Keep only the latest 10 meal plans to avoid storage issues
                if (mealPlans.length > 10) {
                    mealPlans.splice(10);
                }
                
                // Save back to localStorage
                localStorage.setItem('fuelfire_meal_plans', JSON.stringify(mealPlans));
                
                console.log('‚úÖ Meal plan saved to localStorage');
                
                return newPlan.id;
                
            } catch (error) {
                console.error('‚ùå Error saving meal plan to localStorage:', error);
                return null;
            }
        }

        function displayMealPlan(mealPlan, metadata) {
            // Check if new window can be opened (popup blocker check)
            const planWindow = window.open('', '_blank', 'width=1200,height=800,scrollbars=yes');
            
            if (!planWindow) {
                // Popup blocked - show in same page
                showMealPlanInPage(mealPlan, metadata);
                return;
            }
            
            planWindow.document.write(`
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Your FuelFire Meal Plan</title>
                    <link rel="stylesheet" href="styles.css">
                    <style>
                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                            line-height: 1.6;
                            max-width: 1000px;
                            margin: 0 auto;
                            padding: 20px;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            min-height: 100vh;
                        }
                        .meal-plan-container {
                            background: white;
                            border-radius: 20px;
                            padding: 30px;
                            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
                        }
                        .plan-title {
                            color: #4B9CD3;
                            text-align: center;
                            margin-bottom: 30px;
                            font-size: 2.5em;
                        }
                        .section-header {
                            color: #333;
                            border-bottom: 3px solid #4B9CD3;
                            padding-bottom: 10px;
                            margin: 30px 0 20px 0;
                        }
                        .day-header {
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            padding: 15px;
                            border-radius: 15px;
                            margin: 20px 0 15px 0;
                        }
                        .day-plan {
                            background: #f8f9ff;
                            border-radius: 15px;
                            padding: 20px;
                            margin: 15px 0;
                            border-left: 5px solid #4B9CD3;
                        }
                        .meal-item {
                            background: white;
                            padding: 15px;
                            margin: 10px 0;
                            border-radius: 10px;
                            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
                        }
                        .meal-details {
                            margin-top: 8px;
                            color: #666;
                        }
                        .shopping-list {
                            background: #e8f5e8;
                            border-radius: 15px;
                            padding: 20px;
                            margin: 20px 0;
                            border-left: 5px solid #28a745;
                        }
                        .nutrition-info {
                            background: #fff3cd;
                            border: 1px solid #ffeaa7;
                            border-radius: 10px;
                            padding: 15px;
                            margin: 15px 0;
                        }
                        .prep-instructions {
                            background: #e7f3ff;
                            border-radius: 10px;
                            padding: 20px;
                            margin: 15px 0;
                            border-left: 5px solid #007bff;
                        }
                        .highlight {
                            color: #4B9CD3;
                            font-weight: bold;
                        }
                        .metadata {
                            background: #f1f3f4;
                            padding: 15px;
                            border-radius: 10px;
                            margin-bottom: 20px;
                            text-align: center;
                            color: #666;
                        }
                        .print-button {
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            border: none;
                            padding: 15px 30px;
                            border-radius: 25px;
                            font-weight: bold;
                            cursor: pointer;
                            font-size: 16px;
                            margin: 20px 10px;
                        }
                        .print-button:hover {
                            transform: translateY(-2px);
                            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                        }
                        @media print {
                            body { background: white !important; }
                            .print-button { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="meal-plan-container">
                        <div class="metadata">
                            üéØ <strong>Generated:</strong> ${new Date(metadata.generatedAt).toLocaleDateString()} | 
                            <strong>Goal:</strong> ${metadata.goal} | 
                            <strong>Duration:</strong> ${metadata.planDuration}
                        </div>
                        
                        <div style="text-align: center; margin-bottom: 30px;">
                            <button class="print-button" onclick="window.print()">üñ®Ô∏è Print Plan</button>
                            <button class="print-button" onclick="window.close()">‚Üê Back to Quiz</button>
                        </div>
                        
                        ${mealPlan}
                        
                        <div style="text-align: center; margin-top: 40px; padding: 20px; background: #f8f9ff; border-radius: 15px;">
                            <h3>üî• Powered by FuelFire & Claude AI</h3>
                            <p>Your personalized meal plan was generated using advanced AI to match your exact preferences and goals.</p>
                            <button class="print-button" onclick="window.print()">üñ®Ô∏è Print This Plan</button>
                        </div>
                    </div>
                </body>
                </html>
            `);
            
            planWindow.document.close();
            console.log('‚úÖ Meal plan displayed in new window');
        }

        function showMealPlanInPage(mealPlan, metadata) {
            // Hide the quiz and show meal plan in same page
            document.getElementById('quiz-content').innerHTML = `
                <div style="max-width: 800px; margin: 0 auto;">
                    <div style="background: #f1f3f4; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; color: #666;">
                        üéØ <strong>Generated:</strong> ${new Date(metadata.generatedAt).toLocaleDateString()} | 
                        <strong>Goal:</strong> ${metadata.goal} | 
                        <strong>Duration:</strong> ${metadata.planDuration}
                    </div>
                    
                    <div style="text-align: center; margin-bottom: 20px;">
                        <button onclick="window.print()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: bold; cursor: pointer; margin: 0 10px;">
                            üñ®Ô∏è Print Plan
                        </button>
                        <button onclick="location.reload()" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 20px; cursor: pointer; margin: 0 10px;">
                            ‚Üê Back to Quiz
                        </button>
                    </div>
                    
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                        ${mealPlan}
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px; padding: 20px; background: #f8f9ff; border-radius: 15px;">
                        <h3 style="color: #4B9CD3;">üî• Powered by FuelFire & Claude AI</h3>
                        <p style="color: #666;">Your personalized meal plan was generated using advanced AI to match your exact preferences and goals.</p>
                        <button onclick="window.print()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: bold; cursor: pointer;">
                            üñ®Ô∏è Print This Plan
                        </button>
                    </div>
                </div>
            `;
            console.log('‚úÖ Meal plan displayed in same page (popup blocked)');
        }

        // Initialize
        updateTime();
        setInterval(updateTime, 1000);
        showStep(1);
    </script>
</body>
</html>